syms kappa
syms c sigma
K = 1 - c*(3/2-2*exp(-i*kappa)+1/2*exp(-2i*kappa)) + sigma * (exp(i*kappa)+exp(-i*kappa)-2);
assume(kappa,'real')
assume([c,sigma],'positive')
RK = real(K)
IK = imag(K)
K2 = simplify(expand(RK^2 + IK^2))
fK2 = matlabFunction(symfun(K2,[kappa,c,sigma]))

kaps = linspace(0,pi,1024);
cs = linspace(0,3,256);
ss = linspace(0,3,256);

[km,cm,sm] = meshgrid(kaps,cs,ss);

K2m = fK2(km,cm,sm);
K2mMax = max(K2m,[],1);

%%
surf(